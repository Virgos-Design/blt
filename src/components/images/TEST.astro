---
import { generateImage } from 'astro-eleventy-img';
import { generatePlaceholder } from 'astro-eleventy-img';

const { src, alt, sizes = '100vw', widths = [450, 800, 1200] } = Astro.props;

const { webp, avif, jpeg } = generateImage(src, {
	widths,
	formats: ['webp', 'avif', 'jpeg'],
	outputDir: 'public/assets/images/hero',
	urlPath: '/assets/images/hero',
});

generatePlaceholder(src, {
	quality: 70,
	outputDir: 'src/assets/placeholders',
});

const avifSrcset = avif.map(({ srcset }) => srcset).join(',');
const webpSrcset = webp.map(({ srcset }) => srcset).join(',');
const jpegSrcset = jpeg.map(({ srcset }) => srcset).join(',');
---

<picture>
	<source type="image/avif" srcset={avifSrcset} sizes={sizes} />
	<source type="image/webp" srcset={webpSrcset} sizes={sizes} />
	<source type="image/jpeg" srcset={jpegSrcset} sizes={sizes} />
	<img
		class="object-cover w-full h-full"
		src={jpeg[1].url}
		width={jpeg[1].width}
		height={jpeg[1].height}
		alt="The ridged surface of the moon"
	/>
</picture>
